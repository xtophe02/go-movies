{"ast":null,"code":"import { hasProperty, pushUnique } from '../lib/utils.js';\nimport { dateValue, regularizeDate } from '../lib/date.js';\nimport { reFormatTokens, parseDate } from '../lib/date-format.js';\nimport { parseHTML } from '../lib/dom.js';\nimport defaultOptions from './defaultOptions.js';\nconst {\n  language: defaultLang,\n  format: defaultFormat,\n  weekStart: defaultWeekStart\n} = defaultOptions; // Reducer function to filter out invalid day-of-week from the input\n\nfunction sanitizeDOW(dow, day) {\n  return dow.length < 6 && day >= 0 && day < 7 ? pushUnique(dow, day) : dow;\n}\n\nfunction calcEndOfWeek(startOfWeek) {\n  return (startOfWeek + 6) % 7;\n} // validate input date. if invalid, fallback to the original value\n\n\nfunction validateDate(value, format, locale, origValue) {\n  const date = parseDate(value, format, locale);\n  return date !== undefined ? date : origValue;\n} // Validate viewId. if invalid, fallback to the original value\n\n\nfunction validateViewId(value, origValue) {\n  let max = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 3;\n  const viewId = parseInt(value, 10);\n  return viewId >= 0 && viewId <= max ? viewId : origValue;\n} // Create Datepicker configuration to set\n\n\nexport default function processOptions(options, datepicker) {\n  const inOpts = Object.assign({}, options);\n  const config = {};\n  const locales = datepicker.constructor.locales;\n  const rangeSideIndex = datepicker.rangeSideIndex;\n  let {\n    format,\n    language,\n    locale,\n    maxDate,\n    maxView,\n    minDate,\n    pickLevel,\n    startView,\n    weekStart\n  } = datepicker.config || {};\n\n  if (inOpts.language) {\n    let lang;\n\n    if (inOpts.language !== language) {\n      if (locales[inOpts.language]) {\n        lang = inOpts.language;\n      } else {\n        // Check if langauge + region tag can fallback to the one without\n        // region (e.g. fr-CA â†’ fr)\n        lang = inOpts.language.split('-')[0];\n\n        if (locales[lang] === undefined) {\n          lang = false;\n        }\n      }\n    }\n\n    delete inOpts.language;\n\n    if (lang) {\n      language = config.language = lang; // update locale as well when updating language\n\n      const origLocale = locale || locales[defaultLang]; // use default language's properties for the fallback\n\n      locale = Object.assign({\n        format: defaultFormat,\n        weekStart: defaultWeekStart\n      }, locales[defaultLang]);\n\n      if (language !== defaultLang) {\n        Object.assign(locale, locales[language]);\n      }\n\n      config.locale = locale; // if format and/or weekStart are the same as old locale's defaults,\n      // update them to new locale's defaults\n\n      if (format === origLocale.format) {\n        format = config.format = locale.format;\n      }\n\n      if (weekStart === origLocale.weekStart) {\n        weekStart = config.weekStart = locale.weekStart;\n        config.weekEnd = calcEndOfWeek(locale.weekStart);\n      }\n    }\n  }\n\n  if (inOpts.format) {\n    const hasToDisplay = typeof inOpts.format.toDisplay === 'function';\n    const hasToValue = typeof inOpts.format.toValue === 'function';\n    const validFormatString = reFormatTokens.test(inOpts.format);\n\n    if (hasToDisplay && hasToValue || validFormatString) {\n      format = config.format = inOpts.format;\n    }\n\n    delete inOpts.format;\n  } //*** pick level ***//\n\n\n  let newPickLevel = pickLevel;\n\n  if (inOpts.pickLevel !== undefined) {\n    newPickLevel = validateViewId(inOpts.pickLevel, 2);\n    delete inOpts.pickLevel;\n  }\n\n  if (newPickLevel !== pickLevel) {\n    if (newPickLevel > pickLevel) {\n      // complement current minDate/madDate so that the existing range will be\n      // expanded to fit the new level later\n      if (inOpts.minDate === undefined) {\n        inOpts.minDate = minDate;\n      }\n\n      if (inOpts.maxDate === undefined) {\n        inOpts.maxDate = maxDate;\n      }\n    } // complement datesDisabled so that it will be reset later\n\n\n    if (!inOpts.datesDisabled) {\n      inOpts.datesDisabled = [];\n    }\n\n    pickLevel = config.pickLevel = newPickLevel;\n  } //*** dates ***//\n  // while min and maxDate for \"no limit\" in the options are better to be null\n  // (especially when updating), the ones in the config have to be undefined\n  // because null is treated as 0 (= unix epoch) when comparing with time value\n\n\n  let minDt = minDate;\n  let maxDt = maxDate;\n\n  if (inOpts.minDate !== undefined) {\n    const defaultMinDt = dateValue(0, 0, 1);\n    minDt = inOpts.minDate === null ? defaultMinDt // set 0000-01-01 to prevent negative values for year\n    : validateDate(inOpts.minDate, format, locale, minDt);\n\n    if (minDt !== defaultMinDt) {\n      minDt = regularizeDate(minDt, pickLevel, false);\n    }\n\n    delete inOpts.minDate;\n  }\n\n  if (inOpts.maxDate !== undefined) {\n    maxDt = inOpts.maxDate === null ? undefined : validateDate(inOpts.maxDate, format, locale, maxDt);\n\n    if (maxDt !== undefined) {\n      maxDt = regularizeDate(maxDt, pickLevel, true);\n    }\n\n    delete inOpts.maxDate;\n  }\n\n  if (maxDt < minDt) {\n    minDate = config.minDate = maxDt;\n    maxDate = config.maxDate = minDt;\n  } else {\n    if (minDate !== minDt) {\n      minDate = config.minDate = minDt;\n    }\n\n    if (maxDate !== maxDt) {\n      maxDate = config.maxDate = maxDt;\n    }\n  }\n\n  if (inOpts.datesDisabled) {\n    config.datesDisabled = inOpts.datesDisabled.reduce((dates, dt) => {\n      const date = parseDate(dt, format, locale);\n      return date !== undefined ? pushUnique(dates, regularizeDate(date, pickLevel, rangeSideIndex)) : dates;\n    }, []);\n    delete inOpts.datesDisabled;\n  }\n\n  if (inOpts.defaultViewDate !== undefined) {\n    const viewDate = parseDate(inOpts.defaultViewDate, format, locale);\n\n    if (viewDate !== undefined) {\n      config.defaultViewDate = viewDate;\n    }\n\n    delete inOpts.defaultViewDate;\n  } //*** days of week ***//\n\n\n  if (inOpts.weekStart !== undefined) {\n    const wkStart = Number(inOpts.weekStart) % 7;\n\n    if (!isNaN(wkStart)) {\n      weekStart = config.weekStart = wkStart;\n      config.weekEnd = calcEndOfWeek(wkStart);\n    }\n\n    delete inOpts.weekStart;\n  }\n\n  if (inOpts.daysOfWeekDisabled) {\n    config.daysOfWeekDisabled = inOpts.daysOfWeekDisabled.reduce(sanitizeDOW, []);\n    delete inOpts.daysOfWeekDisabled;\n  }\n\n  if (inOpts.daysOfWeekHighlighted) {\n    config.daysOfWeekHighlighted = inOpts.daysOfWeekHighlighted.reduce(sanitizeDOW, []);\n    delete inOpts.daysOfWeekHighlighted;\n  } //*** multi date ***//\n\n\n  if (inOpts.maxNumberOfDates !== undefined) {\n    const maxNumberOfDates = parseInt(inOpts.maxNumberOfDates, 10);\n\n    if (maxNumberOfDates >= 0) {\n      config.maxNumberOfDates = maxNumberOfDates;\n      config.multidate = maxNumberOfDates !== 1;\n    }\n\n    delete inOpts.maxNumberOfDates;\n  }\n\n  if (inOpts.dateDelimiter) {\n    config.dateDelimiter = String(inOpts.dateDelimiter);\n    delete inOpts.dateDelimiter;\n  } //*** view ***//\n\n\n  let newMaxView = maxView;\n\n  if (inOpts.maxView !== undefined) {\n    newMaxView = validateViewId(inOpts.maxView, maxView);\n    delete inOpts.maxView;\n  } // ensure max view >= pick level\n\n\n  newMaxView = pickLevel > newMaxView ? pickLevel : newMaxView;\n\n  if (newMaxView !== maxView) {\n    maxView = config.maxView = newMaxView;\n  }\n\n  let newStartView = startView;\n\n  if (inOpts.startView !== undefined) {\n    newStartView = validateViewId(inOpts.startView, newStartView);\n    delete inOpts.startView;\n  } // ensure pick level <= start view <= max view\n\n\n  if (newStartView < pickLevel) {\n    newStartView = pickLevel;\n  } else if (newStartView > maxView) {\n    newStartView = maxView;\n  }\n\n  if (newStartView !== startView) {\n    config.startView = newStartView;\n  } //*** template ***//\n\n\n  if (inOpts.prevArrow) {\n    const prevArrow = parseHTML(inOpts.prevArrow);\n\n    if (prevArrow.childNodes.length > 0) {\n      config.prevArrow = prevArrow.childNodes;\n    }\n\n    delete inOpts.prevArrow;\n  }\n\n  if (inOpts.nextArrow) {\n    const nextArrow = parseHTML(inOpts.nextArrow);\n\n    if (nextArrow.childNodes.length > 0) {\n      config.nextArrow = nextArrow.childNodes;\n    }\n\n    delete inOpts.nextArrow;\n  } //*** misc ***//\n\n\n  if (inOpts.disableTouchKeyboard !== undefined) {\n    config.disableTouchKeyboard = 'ontouchstart' in document && !!inOpts.disableTouchKeyboard;\n    delete inOpts.disableTouchKeyboard;\n  }\n\n  if (inOpts.orientation) {\n    const orientation = inOpts.orientation.toLowerCase().split(/\\s+/g);\n    config.orientation = {\n      x: orientation.find(x => x === 'left' || x === 'right') || 'auto',\n      y: orientation.find(y => y === 'top' || y === 'bottom') || 'auto'\n    };\n    delete inOpts.orientation;\n  }\n\n  if (inOpts.todayBtnMode !== undefined) {\n    switch (inOpts.todayBtnMode) {\n      case 0:\n      case 1:\n        config.todayBtnMode = inOpts.todayBtnMode;\n    }\n\n    delete inOpts.todayBtnMode;\n  } //*** copy the rest ***//\n\n\n  Object.keys(inOpts).forEach(key => {\n    if (inOpts[key] !== undefined && hasProperty(defaultOptions, key)) {\n      config[key] = inOpts[key];\n    }\n  });\n  return config;\n}","map":{"version":3,"sources":["/home/chrismo/Documents/PROJECTS/go-movies/frontend/node_modules/vanillajs-datepicker/js/options/processOptions.js"],"names":["hasProperty","pushUnique","dateValue","regularizeDate","reFormatTokens","parseDate","parseHTML","defaultOptions","language","defaultLang","format","defaultFormat","weekStart","defaultWeekStart","sanitizeDOW","dow","day","length","calcEndOfWeek","startOfWeek","validateDate","value","locale","origValue","date","undefined","validateViewId","max","viewId","parseInt","processOptions","options","datepicker","inOpts","Object","assign","config","locales","constructor","rangeSideIndex","maxDate","maxView","minDate","pickLevel","startView","lang","split","origLocale","weekEnd","hasToDisplay","toDisplay","hasToValue","toValue","validFormatString","test","newPickLevel","datesDisabled","minDt","maxDt","defaultMinDt","reduce","dates","dt","defaultViewDate","viewDate","wkStart","Number","isNaN","daysOfWeekDisabled","daysOfWeekHighlighted","maxNumberOfDates","multidate","dateDelimiter","String","newMaxView","newStartView","prevArrow","childNodes","nextArrow","disableTouchKeyboard","document","orientation","toLowerCase","x","find","y","todayBtnMode","keys","forEach","key"],"mappings":"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","sourcesContent":["import {hasProperty, pushUnique} from '../lib/utils.js';\nimport {dateValue, regularizeDate} from '../lib/date.js';\nimport {reFormatTokens, parseDate} from '../lib/date-format.js';\nimport {parseHTML} from '../lib/dom.js';\nimport defaultOptions from './defaultOptions.js';\n\nconst {\n  language: defaultLang,\n  format: defaultFormat,\n  weekStart: defaultWeekStart,\n} = defaultOptions;\n\n// Reducer function to filter out invalid day-of-week from the input\nfunction sanitizeDOW(dow, day) {\n  return dow.length < 6 && day >= 0 && day < 7\n    ? pushUnique(dow, day)\n    : dow;\n}\n\nfunction calcEndOfWeek(startOfWeek) {\n  return (startOfWeek + 6) % 7;\n}\n\n// validate input date. if invalid, fallback to the original value\nfunction validateDate(value, format, locale, origValue) {\n  const date = parseDate(value, format, locale);\n  return date !== undefined ? date : origValue;\n}\n\n// Validate viewId. if invalid, fallback to the original value\nfunction validateViewId(value, origValue, max = 3) {\n  const viewId = parseInt(value, 10);\n  return viewId >= 0 && viewId <= max ? viewId : origValue;\n}\n\n// Create Datepicker configuration to set\nexport default function processOptions(options, datepicker) {\n  const inOpts = Object.assign({}, options);\n  const config = {};\n  const locales = datepicker.constructor.locales;\n  const rangeSideIndex = datepicker.rangeSideIndex;\n  let {\n    format,\n    language,\n    locale,\n    maxDate,\n    maxView,\n    minDate,\n    pickLevel,\n    startView,\n    weekStart,\n  } = datepicker.config || {};\n\n  if (inOpts.language) {\n    let lang;\n    if (inOpts.language !== language) {\n      if (locales[inOpts.language]) {\n        lang = inOpts.language;\n      } else {\n        // Check if langauge + region tag can fallback to the one without\n        // region (e.g. fr-CA â†’ fr)\n        lang = inOpts.language.split('-')[0];\n        if (locales[lang] === undefined) {\n          lang = false;\n        }\n      }\n    }\n    delete inOpts.language;\n    if (lang) {\n      language = config.language = lang;\n\n      // update locale as well when updating language\n      const origLocale = locale || locales[defaultLang];\n      // use default language's properties for the fallback\n      locale = Object.assign({\n        format: defaultFormat,\n        weekStart: defaultWeekStart\n      }, locales[defaultLang]);\n      if (language !== defaultLang) {\n        Object.assign(locale, locales[language]);\n      }\n      config.locale = locale;\n      // if format and/or weekStart are the same as old locale's defaults,\n      // update them to new locale's defaults\n      if (format === origLocale.format) {\n        format = config.format = locale.format;\n      }\n      if (weekStart === origLocale.weekStart) {\n        weekStart = config.weekStart = locale.weekStart;\n        config.weekEnd = calcEndOfWeek(locale.weekStart);\n      }\n    }\n  }\n\n  if (inOpts.format) {\n    const hasToDisplay = typeof inOpts.format.toDisplay === 'function';\n    const hasToValue = typeof inOpts.format.toValue === 'function';\n    const validFormatString = reFormatTokens.test(inOpts.format);\n    if ((hasToDisplay && hasToValue) || validFormatString) {\n      format = config.format = inOpts.format;\n    }\n    delete inOpts.format;\n  }\n\n  //*** pick level ***//\n  let newPickLevel = pickLevel;\n  if (inOpts.pickLevel !== undefined) {\n    newPickLevel = validateViewId(inOpts.pickLevel, 2);\n    delete inOpts.pickLevel;\n  }\n  if (newPickLevel !== pickLevel) {\n    if (newPickLevel > pickLevel) {\n      // complement current minDate/madDate so that the existing range will be\n      // expanded to fit the new level later\n      if (inOpts.minDate === undefined) {\n        inOpts.minDate = minDate;\n      }\n      if (inOpts.maxDate === undefined) {\n        inOpts.maxDate = maxDate;\n      }\n    }\n    // complement datesDisabled so that it will be reset later\n    if (!inOpts.datesDisabled) {\n      inOpts.datesDisabled = [];\n    }\n    pickLevel = config.pickLevel = newPickLevel;\n  }\n\n  //*** dates ***//\n  // while min and maxDate for \"no limit\" in the options are better to be null\n  // (especially when updating), the ones in the config have to be undefined\n  // because null is treated as 0 (= unix epoch) when comparing with time value\n  let minDt = minDate;\n  let maxDt = maxDate;\n  if (inOpts.minDate !== undefined) {\n    const defaultMinDt = dateValue(0, 0, 1);\n    minDt = inOpts.minDate === null\n      ? defaultMinDt  // set 0000-01-01 to prevent negative values for year\n      : validateDate(inOpts.minDate, format, locale, minDt);\n    if (minDt !== defaultMinDt) {\n      minDt = regularizeDate(minDt, pickLevel, false);\n    }\n    delete inOpts.minDate;\n  }\n  if (inOpts.maxDate !== undefined) {\n    maxDt = inOpts.maxDate === null\n      ? undefined\n      : validateDate(inOpts.maxDate, format, locale, maxDt);\n    if (maxDt !== undefined) {\n      maxDt = regularizeDate(maxDt, pickLevel, true);\n    }\n    delete inOpts.maxDate;\n  }\n  if (maxDt < minDt) {\n    minDate = config.minDate = maxDt;\n    maxDate = config.maxDate = minDt;\n  } else {\n    if (minDate !== minDt) {\n      minDate = config.minDate = minDt;\n    }\n    if (maxDate !== maxDt) {\n      maxDate = config.maxDate = maxDt;\n    }\n  }\n\n  if (inOpts.datesDisabled) {\n    config.datesDisabled = inOpts.datesDisabled.reduce((dates, dt) => {\n      const date = parseDate(dt, format, locale);\n      return date !== undefined\n        ? pushUnique(dates, regularizeDate(date, pickLevel, rangeSideIndex))\n        : dates;\n    }, []);\n    delete inOpts.datesDisabled;\n  }\n  if (inOpts.defaultViewDate !== undefined) {\n    const viewDate = parseDate(inOpts.defaultViewDate, format, locale);\n    if (viewDate !== undefined) {\n      config.defaultViewDate = viewDate;\n    }\n    delete inOpts.defaultViewDate;\n  }\n\n  //*** days of week ***//\n  if (inOpts.weekStart !== undefined) {\n    const wkStart = Number(inOpts.weekStart) % 7;\n    if (!isNaN(wkStart)) {\n      weekStart = config.weekStart = wkStart;\n      config.weekEnd = calcEndOfWeek(wkStart);\n    }\n    delete inOpts.weekStart;\n  }\n  if (inOpts.daysOfWeekDisabled) {\n    config.daysOfWeekDisabled = inOpts.daysOfWeekDisabled.reduce(sanitizeDOW, []);\n    delete inOpts.daysOfWeekDisabled;\n  }\n  if (inOpts.daysOfWeekHighlighted) {\n    config.daysOfWeekHighlighted = inOpts.daysOfWeekHighlighted.reduce(sanitizeDOW, []);\n    delete inOpts.daysOfWeekHighlighted;\n  }\n\n  //*** multi date ***//\n  if (inOpts.maxNumberOfDates !== undefined) {\n    const maxNumberOfDates = parseInt(inOpts.maxNumberOfDates, 10);\n    if (maxNumberOfDates >= 0) {\n      config.maxNumberOfDates = maxNumberOfDates;\n      config.multidate = maxNumberOfDates !== 1;\n    }\n    delete inOpts.maxNumberOfDates;\n  }\n  if (inOpts.dateDelimiter) {\n    config.dateDelimiter = String(inOpts.dateDelimiter);\n    delete inOpts.dateDelimiter;\n  }\n\n  //*** view ***//\n  let newMaxView = maxView;\n  if (inOpts.maxView !== undefined) {\n    newMaxView = validateViewId(inOpts.maxView, maxView);\n    delete inOpts.maxView;\n  }\n  // ensure max view >= pick level\n  newMaxView = pickLevel > newMaxView ? pickLevel : newMaxView;\n  if (newMaxView !== maxView) {\n    maxView = config.maxView = newMaxView;\n  }\n\n  let newStartView = startView;\n  if (inOpts.startView !== undefined) {\n    newStartView = validateViewId(inOpts.startView, newStartView);\n    delete inOpts.startView;\n  }\n  // ensure pick level <= start view <= max view\n  if (newStartView < pickLevel) {\n    newStartView = pickLevel;\n  } else if (newStartView > maxView) {\n    newStartView = maxView;\n  }\n  if (newStartView !== startView) {\n    config.startView = newStartView;\n  }\n\n  //*** template ***//\n  if (inOpts.prevArrow) {\n    const prevArrow = parseHTML(inOpts.prevArrow);\n    if (prevArrow.childNodes.length > 0) {\n      config.prevArrow = prevArrow.childNodes;\n    }\n    delete inOpts.prevArrow;\n  }\n  if (inOpts.nextArrow) {\n    const nextArrow = parseHTML(inOpts.nextArrow);\n    if (nextArrow.childNodes.length > 0) {\n      config.nextArrow = nextArrow.childNodes;\n    }\n    delete inOpts.nextArrow;\n  }\n\n  //*** misc ***//\n  if (inOpts.disableTouchKeyboard !== undefined) {\n    config.disableTouchKeyboard = 'ontouchstart' in document && !!inOpts.disableTouchKeyboard;\n    delete inOpts.disableTouchKeyboard;\n  }\n  if (inOpts.orientation) {\n    const orientation = inOpts.orientation.toLowerCase().split(/\\s+/g);\n    config.orientation = {\n      x: orientation.find(x => (x === 'left' || x === 'right')) || 'auto',\n      y: orientation.find(y => (y === 'top' || y === 'bottom')) || 'auto',\n    };\n    delete inOpts.orientation;\n  }\n  if (inOpts.todayBtnMode !== undefined) {\n    switch(inOpts.todayBtnMode) {\n      case 0:\n      case 1:\n        config.todayBtnMode = inOpts.todayBtnMode;\n    }\n    delete inOpts.todayBtnMode;\n  }\n\n  //*** copy the rest ***//\n  Object.keys(inOpts).forEach((key) => {\n    if (inOpts[key] !== undefined && hasProperty(defaultOptions, key)) {\n      config[key] = inOpts[key];\n    }\n  });\n\n  return config;\n}\n"]},"metadata":{},"sourceType":"module"}